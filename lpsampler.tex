\documentclass[10pt,letterpaper]{article}

\usepackage[utf8]{inputenc}
\usepackage{amsmath, amsthm, amssymb}
\usepackage{microtype}
\usepackage{lmodern}
\usepackage[hmargin=3.4cm,vmargin=3.2cm]{geometry}
\usepackage{authblk}
\usepackage[runin]{abstract}
\usepackage{sectsty}
\usepackage[font=small,labelfont=small]{caption}
\usepackage[usenames]{xcolor}
\usepackage{aliascnt}
\definecolor{Blue}{RGB}{0, 38, 105}
\definecolor{Green}{RGB}{49, 127, 52}
\usepackage{hyperref}
\hypersetup{
    colorlinks,
    citecolor=Green,
    filecolor=Blue,
    linkcolor=Blue,
    urlcolor=Blue
}

\include{definitions/math}
\include{definitions/fields}
\include{definitions/theoremlike}
\include{definitions/probability}
\include{definitions/entropy}
\include{definitions/linearalgebra}
\include{definitions/citations}
\addbibresource{references/main.bib}

\title{\Large\bf
  Tight Bounds for $L_p$ Samplers, Finding Duplicates in
  Streams, and Related Problems}
\renewcommand\Authfont{\normalsize}
\renewcommand\Affilfont{\small}
\author[1]{Hossein Jowhari}
\author[1]{Mert Sağlam}
\affil[1]{Simon Fraser University, Burnaby, Canada}
\author[1,2]{Gábor Tardos}
\affil[2]{Rényi Institute of Mathematics, Budapest, Hungary}
\date{}

\DeclareMathOperator{\R}{R}
\DeclareMathOperator{\err}{Err}
\DeclareMathOperator{\UR}{UR}
\DeclareMathOperator{\URn}{UR^n}
\DeclareMathOperator{\polylog}{polylog}
\DeclareMathOperator{\poly}{poly}

\begin{document}
\maketitle

\input{abstract}
\input{intro}
\input{lpsamp}
\input{l0samp}
\input{duplicates}
\input{lowerbounds}

\printbibliography

\newpage
\appendix

%\subsection{Space Optimized Heavy Hitters Algorithm}\label{sec:hhUB}
%\begin{theorem}
%[\cite{KaneNPW}]
%\label{thm:hhub}
%Let $x$ be an $n$-dimensional integer vector given by an update stream of $m$
%updates of absolute value at most $M$. There is an $O(\phi^{-p}\log (n/\delta)(\log(mM)+\log\log n))$ space one-pass streaming algorithm which, with probability $1-\delta$, outputs a set $S\subseteq [n]$ such that all $i$ with $|x_i|\geq \phi\|x\|_p$ is in $S$ and $S$ contains no $i$ such that $|x_i|<\frac{\phi}{2}\|x\|_p$.
%\end{theorem}
%\begin{proof}
%Let $\epsilon=\phi^p$, $S = 20\log(n/\delta)$ and $T=64/\epsilon$. Let $h_s: [n]\rightarrow [T]$ be hash functions drawn independently from a 2-wise independent hash family for $s=1,\ldots,S$. We run $ST$ instances of a frequency moment estimation algorithm which gives $1\pm1/16$ approximations to $\|v\|_p^p$ with probability $7/8$, where $v$ are suitably defined sub-vectors of $x$. We refer to each instance of frequency moment estimation algorithm as $D[s,t]$ where $s\in [S]$ and $t\in [T]$.
%The space requirement is $O(\log(mM) + \log\log n)$ per instance, using the algorithm of \cite{KaneNW10}.
%
%Given an update $(i,u)$, we feed it to $D[s,h_{s}(i)]$ for all $s\in [S]$.  Let $C[s,t]$ be the output of the algorithm $D[s,t]$ at the end of the stream. For any $t\in[T]$ and $s\in[S]$, we have
%\begin{align*}
%\E\left[\sum_{i:h_s(i)=t}|x_i|^p\right] = \epsilon \|x\|_p^p/64.
%\end{align*}
%Hence, by an application of Markov's inequality and union bound, with probability 3/4 we have
%\begin{align*}
%(1-1/16)|x_i|^p \leq C[s,t] \leq (1+1/16)(|x_i|^p + \epsilon \|x\|^p_p/8).
%\end{align*}
%Let $e_i$ be the average of $C[s,h_s(i)]$ for $s\in[S]$. By Chernoff bounds, with probability $1-\delta$
%\begin{align*}
%(6/7)|x_i|^p \leq e_i \leq (7/6)(|x_i|^p + \epsilon \|x\|^p_p/8)
%\end{align*}
%for all $i\in [n]$. Hence we can tell apart $i$ for which $|x_i|\geq\phi\|x\|_p$ from $j$ for which $|x_j|<\frac{\phi}{2}\|x\|_p$. The algorithm takes $O(\phi^{-p}\log(n/\delta)(\log(mM)+\log\log n))$ bits as we run $O(\epsilon^{-1}\log(n/\delta))$ instances of the frequency moment estimator of \cite{KaneNW10}.
%\end{proof}
\end{document}
